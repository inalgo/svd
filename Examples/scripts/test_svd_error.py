import numpy as np

U_T = np.array(
[[-0.3277,-0.0618,0.6333,-0.3061,0.0886,0.0860,0.5545,0.2114,-0.1629,-0.0110],
[-0.2058,-0.2365,0.0696,0.0856,-0.5769,-0.3116,0.1879,-0.3287,0.3170,0.4645],
[-0.2439,0.1654,-0.3094,0.2327,0.3000,0.3010,0.2090,-0.0980,-0.3489,0.6385],
[-0.3557,0.1459,-0.4982,-0.3086,-0.5430,0.1633,0.0838,0.3344,-0.1737,-0.1955],
[-0.2773,0.3562,-0.2611,0.1624,0.3220,-0.2578,0.4100,-0.0034,0.5492,-0.2483],
[-0.2744,0.1750,0.2745,0.7140,-0.1890,-0.1812,-0.2100,0.3983,-0.1802,-0.0717],
[-0.3627,-0.5375,-0.2255,0.0028,0.2530,-0.4580,-0.0323,-0.1918,-0.3949,-0.2473],
[-0.3258,-0.3586,0.0477,0.2706,-0.0238,0.6824,-0.0704,-0.2545,0.2655,-0.2886],
[-0.3207,-0.2243,-0.0047,-0.2658,0.2652,-0.0292,-0.4519,0.4723,0.3909,0.3534],
[-0.4141,0.5160,0.2312,-0.2637,0.0077,-0.0512,-0.4290,-0.4926,-0.0881,-0.0465]]
)

VT_T = np.array(
[[-0.4430,-0.2291,-0.2393,-0.2387,-0.2952,-0.2803,-0.2942,-0.4407,-0.3754,-0.2229],
[0.4589,-0.2245,0.3133,-0.0492,0.4448,0.0594,-0.1413,-0.1387,-0.4082,-0.4809],
[-0.4012,-0.6663,0.3622,0.4110,0.0024,0.2400,-0.0043,0.0229,0.1916,-0.0141],
[0.3173,-0.0550,-0.4559,0.5059,-0.0609,0.3555,-0.0344,-0.4876,-0.1211,0.2208],
[0.3665,-0.5358,-0.1609,-0.4246,-0.0216,-0.0478,-0.3686,0.1479,0.1844,0.4217],
[-0.0040,-0.0548,-0.1053,0.2268,0.4804,-0.6757,0.0345,-0.3003,0.3932,0.0337],
[-0.2164,0.3417,0.4058,0.0221,0.2638,0.0981,-0.5301,-0.1952,-0.1576,0.4980],
[0.1014,0.2067,0.0303,0.0026,-0.2084,0.1926,-0.5178,-0.1402,0.6004,-0.4662],
[-0.1566,-0.0239,0.0219,-0.5324,0.2703,0.4001,0.3916,-0.4876,0.2553,0.0387],
[0.3398,-0.0085,0.5500,-0.0033,-0.5421,-0.2613,0.2297,-0.3751,0.0448,0.1558]]
)



VT = np.array(
[[0.3398,-0.0085,0.5500,-0.0033,-0.5421,-0.2613,0.2297,-0.3751,0.0448,0.1558],
[-0.1566,-0.0239,0.0219,-0.5324,0.2703,0.4001,0.3916,-0.4876,0.2553,0.0387],
[-0.1014,-0.2067,-0.0303,-0.0026,0.2084,-0.1926,0.5178,0.1402,-0.6004,0.4662],
[-0.2164,0.3417,0.4058,0.0221,0.2638,0.0981,-0.5301,-0.1952,-0.1576,0.4980],
[-0.0040,-0.0548,-0.1053,0.2268,0.4804,-0.6757,0.0345,-0.3003,0.3932,0.0337],
[0.3665,-0.5358,-0.1609,-0.4246,-0.0216,-0.0478,-0.3686,0.1479,0.1844,0.4217],
[-0.3173,0.0550,0.4559,-0.5059,0.0609,-0.3555,0.0344,0.4876,0.1211,-0.2208],
[-0.4012,-0.6663,0.3622,0.4110,0.0024,0.2400,-0.0043,0.0229,0.1916,-0.0141],
[0.4589,-0.2245,0.3133,-0.0492,0.4448,0.0594,-0.1413,-0.1387,-0.4082,-0.4809],
[0.4430,0.2291,0.2393,0.2387,0.2952,0.2803,0.2942,0.4407,0.3754,0.2229]]
)

def ms(m, g):
    a = np.copy(m)
    for i in range(m.shape[0]):
        if np.sign(m[i][0]) != g[i]:
            a[i] = -a[i]
    return a

rmap = [-1, -1, 1, 1, 1, -1, 1, -1, 1, -1]
rmap = rmap[::-1]

#VT = ms(VT, rmap)

U = np.array(
[[0.0110,0.1629,-0.2114,-0.5545,0.0860,0.0886,-0.3061,-0.6333,0.0618,-0.3277],
[-0.4645,-0.3170,0.3287,-0.1879,-0.3116,-0.5769,0.0856,-0.0696,0.2365,-0.2058],
[-0.6385,0.3489,0.0980,-0.2090,0.3010,0.3000,0.2327,0.3094,-0.1654,-0.2439],
[0.1955,0.1737,-0.3344,-0.0838,0.1633,-0.5430,-0.3086,0.4982,-0.1459,-0.3557],
[0.2483,-0.5492,0.0034,-0.4100,-0.2578,0.3220,0.1624,0.2611,-0.3562,-0.2773],
[0.0717,0.1802,-0.3983,0.2100,-0.1812,-0.1890,0.7140,-0.2745,-0.1750,-0.2744],
[0.2473,0.3949,0.1918,0.0323,-0.4580,0.2530,0.0028,0.2255,0.5375,-0.3627],
[0.2886,-0.2655,0.2545,0.0704,0.6824,-0.0238,0.2706,-0.0477,0.3586,-0.3258],
[-0.3534,-0.3909,-0.4723,0.4519,-0.0292,0.2652,-0.2658,0.0047,0.2243,-0.3207],
[0.0465,0.0881,0.4926,0.4290,-0.0512,0.0077,-0.2637,-0.2312,-0.5160,-0.4141]]
)

A = np.array(
[[0.0710,0.0030,0.2000,0.1260,0.1290,0.1200,0.0660,0.1960,0.2060,0.1070],
[0.0220,0.1250,0.0670,0.1120,0.0270,0.1180,0.1330,0.1050,0.0560,0.0700],
[0.2190,0.0760,0.0270,0.0520,0.1350,0.0390,0.0460,0.0850,0.0870,0.0970],
[0.1990,0.2450,0.1190,0.0660,0.1600,0.0560,0.1370,0.1810,0.1340,0.0010],
[0.2470,0.0770,0.0850,0.0190,0.1360,0.1350,0.0350,0.1190,0.0500,0.0790],
[0.1880,0.0290,0.0480,0.1970,0.0790,0.1980,0.0840,0.0640,0.1020,0.0320],
[0.1570,0.1470,0.0270,0.0510,0.0120,0.1440,0.1370,0.2530,0.1800,0.2030],
[0.1300,0.0890,0.0170,0.1610,0.1280,0.0380,0.1540,0.1200,0.2210,0.1640],
[0.1530,0.0710,0.0700,0.0330,0.0590,0.0900,0.1090,0.2140,0.2270,0.0790],
[0.2540,0.0120,0.1960,0.1010,0.2130,0.1310,0.1750,0.2460,0.1100,0.0190]]
)

s = np.array(
[1.1865, 0.3100, 0.2606, 0.2269, 0.2030, 0.1859, 0.1136, 0.1068, 0.0246, 0.0043]
)

s = s[::-1]
S = np.diag(s)

def unrev(m, t):
    a = np.copy(m)
    if t == 1:
        for i in range(m.shape[0]):
            if m[i][0] < 0:
                a[i] = -a[i]
    elif t == 2:
        for i in range(m.shape[1]):
            if m[0][i] < 0:
                a[:, i] = -a[:, i]
    return a

def check(t1, t2):
    print "check(%i,%i)"%(t1,t2)
    u1 = unrev(U, t1)
    v1 = unrev(VT, t2)
    g = u1.dot(S.dot(v1))
    #print u1
    print "%f %f" % (g[0][0], np.linalg.norm(A - g))

for t1 in [0,1,2]:
    for t2 in [0,1,2]:
        check(t1,t2)