Что-то похожее на черновик по SVD - разложению.


**SVD - разложение **

---

Сингулярное или SVD разложение, это представление матрицы $A_{m\times{n}}$ ,ввиде произведения трёх матриц специального вида
$\hspace{5em} A_{m\times{n}} = U_{m\times{m}} \cdot S_{m\times{n}} \cdot V_{n\times{n}}^T$
 

, где  $U$ и $V$ -- унитарные матрицы --- матрицы удовлетворяющие уравнению $\hspace{5em}$ $A^*A = AA^* = I$ 
где $M^*$ --- операция сопряжения, обозначающая последовательно применённые операции транспонирования и комплексного сопряжения всех элементов матрицы.
$\hspace{5em}$$M^* = \overline{M^T}$

$S$ --- диагональная матрица, вида $S = diag(\sigma_1, \dots, \sigma_r, 0\:, \dots, 0) $

- элементы $\sigma_i$ , называются сингулярными числами матрицы $A$
- строки $u_i$ ,матрицы $U$, называются левыми сингулярными векторами матрицы $A$
- столбцы $v_i$ ,матрицы $V$, называются правыми сингулярными векторами матрицы $A$

---

**Свойства сингулярного разложения[^1]**

1. Существует и единственно (с точностью до порядка и знаков сингулярных чисел и векторов), для любой матрицы $A$

2.  Левые и правые сингулярные векторы, являются собственными векторами матриц  $AA^T$ и $A^TA$ соответственно. 

3.  Сингулярные числа являются квадратами соответственных собственных чисел матриц  $AA^T$ и $A^TA$ 

4.  Количество ненулевых собственных чисел равно рангу матрицы $A$

5. Возьмём матрицу $A_k$, такую что $A_k = U*S_k*V^T$, где $S_k$,  это матрица $S$, в которой $r-k$ наименьших сингулярных чисел заменены на нули.

 Тогда $A_k$, это матрица  с рангом $k$, лучше всего приближающая матрицу $A$, по норме Фробениуса.
  или, если переписать в кванторах

 $\hspace{5em}$ $\min\limits_{B \:: rank(B) = k} ||A-B||_2 = ||A-A_k||_2$
 
  Норма Фробениуса матрицы $A$ или $||A||_2$ равна
 $\hspace{5em}$$||A||_2 = \: \sqrt{\sum\limits_{i = 1}^m \sum\limits_{j=1}^n a_{ij}^2} $




---
**Доказательство свойств **


Пусть $A = U \cdot S \cdot V^*$ тогда $AA^T = U \cdot S^2 \cdot U^*$ и $A^TA = V \cdot S^2 \cdot V^*$.
Тогда так как $AA^T$ и $AA^T$ симметричные квадратные матрицы, размеров $m\times{m}$ и $n\times{n}$ соответственно и мы знаем, что квадратные симметричные матрицы, всегда дигонализируемы, то есть представимы в виде произведения матриц $H \cdot Z \cdot H^T$, где $H$ - унитарная матрица из собственных векторов, а $Z = diag(\lambda_1,\dots, \lambda_r, 0 ,\dots, 0)$ , где $\lambda_i$ собственные числа. Это оказывает свойства [2] и [3]

Также мы знаем что ранг матрицы $A$ совпадает в рангом матриц $AA^T$  и $A^TA$ , а их ранг, равен числу ненулевых собственных чисел, которое по свойству [3] совпадает с количеством ненулевых сингулярных чисел. Это доказывает свойство [4]

---

**Пример**

Пусть $A  $

 \begin{pmatrix}
1 & 2 & 3\\
3 & 1 & 5\\
0 & 5 & 4 \\
 \end{pmatrix}
 
Тогда 
$
\begin{array}{c|c|c}
U & S & V \\
\hline
\begin{array}{rrr}
    -0.43 & -0.02 & -0.90 \\
-0.60 & -0.74 &  0.30 \\
-0.68 &  0.67 &  0.30 \\
  \end{array} &
  \begin{array}{rrr}
  8.78 &  0 &  0 \\
0 &  3.58 &  0 \\
0 &  0 &  0 \\
  \end{array}&
  \begin{array}{rrr}
    -0.25 & -0.63 & -0.74 \\
-0.55 &  0.72 & -0.42 \\
-0.80 & -0.30 &  0.53 \\
  \end{array}
 \end{array}
$

Как мы видим, у матрицы $S$ , два ненулевых сингулярных числа. По свойству [4], это значит $rank(A) = 2$
Это можно проверить и по другому. Можно заметить что $(2) + (3) = 3*(1) $ где $(i)$ это $i$ строчка матрицы $A$.  Это значит что $rank(A) = 2$

$ 
\begin{array}{c|c}
AA^T & A^TA \\
\hline
\begin{array}{ccc}
    26 & 9 & 5 \\
    9 & 42 & 1 \\
    5 &1 & 1  \\
  \end{array} &
  \begin{array}{ccc}
    17 & 20 & 9 \\
    20 & 25 & 5 \\
    9 & 5 & 27  \\
  \end{array} \\
\end{array}
$


---
**Применения сингулярного разложения**

1. Поиск псевдообратной матрицы[^2]
<br>
$\hspace{5em}$ Пусть у нас есть матричное уравнение $Ax = b$
$\hspace{5em}$ Если $A$ обратима, то решение этого уравнения $x = A^{-1}b$
$\hspace{5em}$ Но если $A$ необратима, то решения не существует или их бесконечно много
$\hspace{5em}$ Но мы можем найти так называемое псевдорешение, то есть такое $\tilde{x}$, что
$\hspace{5em}$ $\tilde{x} = \underset{x}{\mathrm{argmin}}||Ax-b||_2$
$\hspace{5em}$ Доказано что $\tilde{x} = A^+b = V \cdot S^+ \cdot U^T \cdot b$
$\hspace{5em}$ Где $A^+$ - называется псевдообратной к матрице $A$
$\hspace{5em}$ Матрицы $U$, $S$ и $V$ это сингулярное разложение матрицы $A$
$\hspace{5em}$ Матрица  $S^+ = diag(^1/_{\sigma_1}, \dots, ^1/_{\sigma_r}, 0 \dots, 0)$
<br>
2. Подавление шумов на изображении.

3. Уменьшение размерности данных.

4. Решение задачи наименьших квадратов.
<br>
Пусть матрица $A$ вот такого вида
$
\left\( \begin{array}{cccccc}
5 & 2 & 7 & 9 & 1 \\
2 & 5 & 5 & 5 & 9 \\
\end{array}\right\)^T
$
<br>
, где каждая строка вида $(x , y)$  , соответствует точке с координатами $(x,y)$
Пусть мы хотим найти прямую $y = a + bx$ , которая лучше всего описывает эти точки. 
Составим дополнительную матрицу $B$
$
\left\( \begin{array}{cccccc}
1 & 1 & 1 & 1 & 1 \\
5 & 2 & 7 & 9 & 1 \\
\end{array}\right\)^T
$
<br>
То есть мы хотим решить матричное уравнение $Bk = y$ , где $k = (a,b)^T$ , а $y = (y_1,\dots,y_n)^T$, где $y_i$ ордината $i$ точки, а $B_{2, i} = x_i =$ абсцисса $i$ точки.
Матрица $A$, прямоугольная, поэтому мы сможем найти только псевдорешение.
<br>
Тогда $SVD$ разложение матрицы $B$ будет
$
\begin{array}{c|c|c}
U & S & V \\
\hline
\begin{array}{rrrrr}
0.40 & 0.21 & -0.55 & -0.65 & -0.25 & \\
0.17 & 0.59 & 0.15 & 0.42 & -0.66 & \\
0.55 & -0.05 & 0.76 & -0.34 & 0.05 & \\
0.71 & -0.31 & -0.31 & 0.53 & 0.17 & \\
0.09 & 0.72 & -0.04 & 0.05 & 0.69 & \\
  \end{array} &
  \begin{array}{rr}
 12.79 & 0 \\
0 & 1.17 \\
0 & 0 \\
0 & 0 \\
0 & 0 \\
  \end{array}&
  \begin{array}{rr}
0.15 & 0.99 \\
0.99 & -0.15 \\
  \end{array}
 \end{array}
$
<br>
Тогда псевдобратные матрицы к матрицам $S$ и $B$ будут равны
$
\begin{array}{c|c}
S^+ & B^+ \\
\hline
\begin{array}{rrrrr}
0.08 & 0 & 0 & 0 & 0\\
0 & 0.85 & 0 & 0 & 0\\
  \end{array} &
  \begin{array}{rrrrr}
0.18 & 0.50 & -0.04 & -0.25 & 0.61\\
0 & -0.06 & 0.05 & 0.09 & -0.09\\
  \end{array}
 \end{array}
$
<br>
Перемножая $B^+ \cdot y = (6.90,-0.35)^T$
Значит нужная нам прямая имеет уравнение $y = 6.9 - 0.35x$
<br>
<img src="https://pp.vk.me/c638621/v638621325/e7c4/C1RG0uOATM0.jpg">
<br>
На картинке зелеными кружками обозначены точки, а желтая линия это решение.
5. Восстановление утраченных данных.

---
**Алгоритмы для вычисления сингулярного разложения **

<table border="2" align="right">
  <tr border="2">
    <th >Algorithm's name</th>
    <th width="150">Class</th>
    <th width="150">Complexity</th>
    <th width="150">Numerical stability</th>
    <th width="150">Compute<br>  what?</th>
    <th >Link</th>
  </tr>
  <tr>
  <td >1. Convert to bidiagonal  (Householder)  
  <br/><br/>  2. Found roots of the charasterictic polynomial  (implicit inverse power  method) 
  <br/> <br/> 3. Found singular vectors (back propagate)    </td>
    <td >Exact</td>
    <td >$O(2mn^2+2nm^2)$</td>
    <td >Good</td>
    <td >Full  Matrices</td>
    <td> 
    <a href="https://www.quora.com/Whats-the-time-complexity-of-NumPys-SVD-method"> link </a>
    </td>
  </tr>
  <tr >
    <td >Jacobi rotations</td>
    <td >Iterative</td>
    <td >???</td>
    <td >Very  Good</td>
    <td >Full  Matrices</td>
	<td>
	<a href="http://www.ams.org/journals/tran/1960-094-01/S0002-9947-1960-0109825-2/S0002-9947-1960-0109825-2.pdf">link</a>
    </td>
  </tr>
  <tr>
    <td >1. Symmetric QR decomposition of $A^TA$  </td>
    <td ></td>
    <td ></td>
    <td ></td>
    <td ></td>
    <td ></td>
  </tr>
  <tr>
    <td >(Monte Carlo)  <br/>  k - rows</td>
    <td >Iterative</td>
    <td >$O(m*n*log(k)$</td>
    <td >Good</td>
    <td >k-th approximation     of full matricies</td>
    <td >
    <a href="https://arxiv.org/pdf/0909.4061v2.pdf"> link</a>
    </td>
  </tr>
  <tr>
    <td >LAPACK ( xBDSCR) <br/>   on bidiagonal matrix  n×n</td>
    <td >Exact</td>
    <td >$O(n*k)$</td>
    <td >Good</td>
    <td >k-th  approximation     of full matricies</td>
	<td>
	<a href="http://www.netlib.org/lapack/lawnspdf/lawn166.pdf">link</a>
    </td>
  </tr>
</table>


**Литература**

[^1]: Курс Аналитической геометрии и линейной алгебры. Беклемишев Д. В. (с. 234)

[^2]: Дополнительные главы линейной алгебры. Беклемишев  Д. В. (с. 187)
